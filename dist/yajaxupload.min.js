function AjaxUpload(b){var a=this;this.uploadUrl=b.uploadUrl;this.inputFile=b.inputFile;this.progressBar=b.progressBar;this.fileKey=(b.fileKey)?b.fileKey:"uploadingFile";this.params=(b.params)?b.params:{};this.percentage=0;this.percentageWidth="0%";this.onComplete_=function(c){console.log(c)};this.onError_=function(c){console.error(c)};this.onCancel_=function(c){console.log(c)};this.upload=function(){var e=a.inputFile.files[0];if(e){a.percentage=0;a.percentageWidth="0%";var d=new FormData();d.append(a.fileKey,e);for(k in a.params){d.append(k,a.params[k])}var f=new XMLHttpRequest();var c;f.upload.addEventListener("progress",a.uploadProgress,false);f.addEventListener("load",function(g){a.uploadProgress;try{c=JSON.parse(g.target.responseText)}catch(h){c={error:h.message}}a.onComplete_(c)},false);f.addEventListener("error",function(g){try{c=JSON.parse(g.target.responseText)}catch(h){c={error:h.message}}a.onError_(c)},false);f.addEventListener("abort",function(g){a.uploadProgress;try{c=JSON.parse(g.target.responseText)}catch(h){c={error:h.message}}a.onCancel_(c)},false);f.open("POST",a.uploadUrl);f.send(d)}};this.uploadProgress=function(c){if(c.lengthComputable){var d=Math.round(c.loaded*100/c.total);var e=d.toString()+"%";a.percentage=d;a.percentageWidth=e;a.progressBar.innerHTML=a.percentageWidth;a.progressBar.setAttribute("aria-valuenow",a.percentage);a.progressBar.style.width=a.percentageWidth}else{a.percentageWidth="unable to compute";a.progressBar.innerHTML=a.percentageWidth}};this.onComplete=function(c){a.onComplete_=c;return a};this.onError=function(c){a.onError_=c;return a};this.onCancel=function(c){a.onCancel_=c;return a}};